<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AETERNA: STATECRAFT | GRAND STRATEGY ENGINE v5.0 (ULTIMATE)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Teko:wght@300;400;600&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #020202;
            --bg-panel: #0d1117;
            --bg-header: #161b22;
            
            --cyber-blue: #00f3ff;
            --cyber-gold: #ffd700;
            --cyber-red: #ff2a2a;
            --cyber-green: #0aff0a;
            --cyber-purple: #bc13fe;
            --cyber-orange: #ff9100;
            
            --border: 1px solid rgba(255, 255, 255, 0.1);
            --glass: rgba(13, 17, 23, 0.95);
            
            --font-head: 'Teko', sans-serif;
            --font-ui: 'Rajdhani', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; user-select: none; outline: none; }
        
        body {
            background-color: var(--bg-dark);
            color: #c9d1d9;
            font-family: var(--font-ui);
            margin: 0; height: 100vh; overflow: hidden;
            display: flex; flex-direction: column;
            background-image: radial-gradient(circle at 50% 50%, #0d1117 0%, #000 100%);
        }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--cyber-blue); }

        /* --- TOP BAR --- */
        #top-hud {
            height: 50px; background: var(--bg-header); border-bottom: 1px solid #30363d;
            display: flex; align-items: center; padding: 0 15px; gap: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5); z-index: 100; font-size: 12px;
        }
        
        .hud-group { display: flex; gap: 10px; border-right: 1px solid #30363d; padding-right: 10px; height: 30px; align-items: center; }
        .metric-box { display: flex; flex-direction: column; min-width: 50px; cursor: help; }
        .metric-val { font-family: var(--font-mono); font-weight: bold; color: #fff; font-size: 13px; }
        .metric-lbl { font-size: 9px; color: #8b949e; letter-spacing: 0.5px; text-transform: uppercase; }
        
        .res-icon { margin-right: 3px; width:12px; display:inline-block; text-align:center; }
        
        .defcon-box { 
            font-family: var(--font-head); font-size: 20px; padding: 2px 10px; 
            border: 1px solid var(--cyber-red); color: var(--cyber-red);
            text-shadow: 0 0 5px var(--cyber-red); cursor: pointer;
            animation: pulse-slow 3s infinite; border-radius: 4px;
        }

        /* --- MAIN LAYOUT --- */
        #viewport {
            flex: 1; display: grid; 
            grid-template-columns: 320px 1fr 320px;
            overflow: hidden; gap: 1px; background: #21262d;
        }

        .panel { background: var(--bg-panel); display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        /* TABS */
        .nav-tabs { display: flex; background: #010409; height: 35px; border-bottom: var(--border); overflow-x: auto; }
        .nav-btn {
            flex: 1; min-width: 60px; background: transparent; border: none; color: #8b949e;
            font-family: var(--font-head); font-size: 16px; letter-spacing: 0.5px;
            cursor: pointer; transition: 0.2s; border-bottom: 2px solid transparent; white-space: nowrap; padding: 0 10px;
        }
        .nav-btn:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .nav-btn.active { color: var(--cyber-blue); border-bottom-color: var(--cyber-blue); background: rgba(0, 243, 255, 0.05); }

        .content-area { padding: 10px; overflow-y: auto; flex: 1; display: none; }
        .content-area.active { display: block; animation: fadeIn 0.2s; }

        /* WIDGETS */
        .card { 
            background: rgba(255,255,255,0.02); border: 1px solid #30363d; 
            padding: 10px; margin-bottom: 8px; border-radius: 6px; 
        }
        .card-head { 
            font-size: 11px; font-weight: bold; color: var(--cyber-gold); 
            margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1px;
            display: flex; justify-content: space-between; border-bottom: 1px solid #30363d; padding-bottom: 3px;
        }

        .row-kv { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 3px; font-family: var(--font-mono); align-items: center; }
        .bar-cont { height: 4px; background: #21262d; border-radius: 2px; overflow: hidden; margin: 3px 0 6px 0; }
        .bar-fill { height: 100%; transition: width 0.5s; }

        /* BUTTONS */
        .btn-main {
            width: 100%; padding: 8px; background: linear-gradient(90deg, #161b22, #21262d);
            border: 1px solid #30363d; color: #c9d1d9; text-align: left;
            font-family: var(--font-ui); font-size: 13px; cursor: pointer; border-radius: 4px;
            margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center;
        }
        .btn-main:hover { border-color: var(--cyber-blue); color: #fff; padding-left: 12px; }
        .btn-main:disabled { opacity: 0.5; cursor: not-allowed; border-color: #30363d; }
        .btn-danger { border-color: #551111; color: #ffadad; }
        .btn-danger:hover { border-color: var(--cyber-red); background: rgba(255,42,42,0.1); }

        .cost-tag { font-size: 10px; font-family: var(--font-mono); color: #8b949e; background: #0d1117; padding: 2px 4px; border-radius: 3px; }

        /* MAP AREA */
        #map-wrapper { position: relative; background: #050505; overflow: hidden; }
        #map-canvas { display: block; width: 100%; height: 100%; cursor: crosshair; }
        
        #map-ui { position: absolute; top: 10px; left: 10px; display: flex; flex-direction: column; gap: 5px; }
        .map-mode { 
            background: rgba(0,0,0,0.8); color: #aaa; border: 1px solid #30363d; padding: 5px 10px; 
            font-size: 10px; cursor: pointer; backdrop-filter: blur(4px); font-weight: bold; border-radius: 4px;
        }
        .map-mode.active { border-color: var(--cyber-blue); color: var(--cyber-blue); box-shadow: 0 0 10px rgba(0,243,255,0.1); }

        #province-detail {
            position: absolute; bottom: 10px; right: 10px; width: 280px;
            background: rgba(13, 17, 23, 0.95); border: 1px solid var(--cyber-blue);
            padding: 10px; backdrop-filter: blur(10px); display: none; border-radius: 6px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8); z-index: 50;
        }

        /* TICKER */
        #news-ticker {
            height: 24px; background: var(--cyber-gold); color: #000;
            display: flex; align-items: center; overflow: hidden; white-space: nowrap;
            font-family: var(--font-mono); font-weight: bold; font-size: 12px;
            position: fixed; bottom: 0; left: 0; width: 100%; z-index: 200;
        }

        /* MODALS */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000;
            display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px);
        }
        .modal-window {
            width: 600px; max-height: 85vh; background: #0d1117; border: 1px solid #30363d;
            display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(0,0,0,0.8); border-radius: 8px;
        }
        .mw-header { background: #161b22; padding: 12px; font-family: var(--font-head); font-size: 20px; color: #fff; border-bottom: 1px solid #30363d; display:flex; justify-content:space-between; }
        .mw-body { padding: 15px; overflow-y: auto; color: #c9d1d9; line-height: 1.5; font-size: 13px; }
        .mw-footer { padding: 12px; border-top: 1px solid #30363d; display: flex; justify-content: flex-end; gap: 10px; background: #161b22; }

        .tag-diplo { display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 10px; font-weight: bold; margin-right: 5px; }
        .tag-ally { background: rgba(10, 255, 10, 0.1); color: var(--cyber-green); border: 1px solid var(--cyber-green); }
        .tag-enemy { background: rgba(255, 42, 42, 0.1); color: var(--cyber-red); border: 1px solid var(--cyber-red); }

        /* ANIMATIONS */
        @keyframes pulse-slow { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scroll-left { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
    </style>
</head>
<body>

<div id="top-hud">
    <div style="font-family: var(--font-head); font-size: 24px; color: #fff; letter-spacing: 2px; margin-right: 20px;">
        AETERNA <span style="color:var(--cyber-blue)">OMEGA</span> <span style="font-size:12px; color:#666">v5.0</span>
    </div>

    <div class="hud-group">
        <div class="metric-box" title="Hazine (Nakit)">
            <span class="metric-val" id="hud-money">$0M</span>
            <span class="metric-lbl"><i class="fa-solid fa-sack-dollar res-icon"></i>HZN</span>
        </div>
        <div class="metric-box" title="Politik G√º√ß">
            <span class="metric-val" id="hud-pp" style="color:var(--cyber-gold)">0</span>
            <span class="metric-lbl"><i class="fa-solid fa-landmark res-icon"></i>PP</span>
        </div>
        <div class="metric-box" title="ƒ∞stihbarat Aƒüƒ±">
            <span class="metric-val" id="hud-intel" style="color:var(--cyber-purple)">0</span>
            <span class="metric-lbl"><i class="fa-solid fa-eye res-icon"></i>INT</span>
        </div>
    </div>

    <div class="hud-group">
        <div class="metric-box" title="Enerji Rezervi">
            <span class="metric-val" id="hud-energy" style="color:var(--cyber-blue)">0%</span>
            <span class="metric-lbl"><i class="fa-solid fa-bolt res-icon"></i>ENJ</span>
        </div>
        <div class="metric-box" title="Petrol Rezervi">
            <span class="metric-val" id="hud-oil" style="color:#aaa">0k</span>
            <span class="metric-lbl"><i class="fa-solid fa-oil-well res-icon"></i>PET</span>
        </div>
        <div class="metric-box" title="ƒ∞stikrar">
            <span class="metric-val" id="hud-stab">0%</span>
            <span class="metric-lbl"><i class="fa-solid fa-scale-balanced res-icon"></i>ƒ∞ST</span>
        </div>
    </div>

    <div class="hud-group" style="flex:1; justify-content:center;">
        <div class="defcon-box" onclick="game.toggleDefcon()" id="defcon-disp">DEFCON 5</div>
    </div>

    <div class="game-clock">
        <div id="date-display" style="font-weight:bold; color:var(--cyber-gold)">01 OCAK 2025</div>
        <div style="font-size:10px; color:#666; cursor:pointer; text-align:right;" onclick="game.togglePause()">[ SPACE: DURDUR ]</div>
    </div>
</div>

<div id="viewport">
    
    <div class="panel">
        <div class="nav-tabs">
            <button class="nav-btn active" onclick="ui.tab('l', 'dash')"><i class="fa-solid fa-building-columns"></i></button>
            <button class="nav-btn" onclick="ui.tab('l', 'eco')"><i class="fa-solid fa-chart-line"></i></button>
            <button class="nav-btn" onclick="ui.tab('l', 'soc')"><i class="fa-solid fa-users"></i></button>
            <button class="nav-btn" onclick="ui.tab('l', 'res')"><i class="fa-solid fa-flask"></i></button>
        </div>

        <div id="tab-l-dash" class="content-area active">
            <div class="card">
                <div class="card-head">DEVLET Y√ñNETƒ∞Mƒ∞</div>
                <div class="row-kv"><span>Lider:</span> <span style="color:var(--cyber-blue)">Ba≈ükan [OYUNCU]</span></div>
                <div class="row-kv"><span>ƒ∞deoloji:</span> <span>Teknokratik Milliyet√ßilik</span></div>
                <div class="row-kv"><span>H√ºk√ºmet Desteƒüi:</span> <span id="gov-support">55%</span></div>
                <div class="bar-cont"><div class="bar-fill" id="bar-support" style="width:55%; background:var(--cyber-green)"></div></div>
            </div>

            <div class="card">
                <div class="card-head">ACƒ∞L DURUM YASALARI</div>
                <button class="btn-main" onclick="game.action('law_martial')">
                    <span><i class="fa-solid fa-person-military-pointing"></i> Sƒ±kƒ±y√∂netim ƒ∞lanƒ±</span> <span class="cost-tag">150 PP</span>
                </button>
                <button class="btn-main" onclick="game.action('law_censorship')">
                    <span><i class="fa-solid fa-eye-slash"></i> Medya Sans√ºr√º</span> <span class="cost-tag">50 PP</span>
                </button>
                <button class="btn-main" onclick="game.action('law_election')">
                    <span><i class="fa-solid fa-box-archive"></i> Erken Se√ßim</span> <span class="cost-tag">Riskli</span>
                </button>
            </div>
            
            <div class="card">
                <div class="card-head">MECLƒ∞S DAƒûILIMI</div>
                <canvas id="parliament-chart" height="150"></canvas>
            </div>
        </div>

        <div id="tab-l-eco" class="content-area">
            <div class="card">
                <div class="card-head">MAKROEKONOMƒ∞</div>
                <div class="row-kv"><span>GSYƒ∞H (GDP):</span> <span id="eco-gdp">$900B</span></div>
                <div class="row-kv"><span>B√ºy√ºme:</span> <span id="eco-growth" style="color:var(--cyber-green)">+3.2%</span></div>
                <div class="row-kv"><span>Enflasyon:</span> <span id="eco-inf" style="color:var(--cyber-red)">12.5%</span></div>
                <div class="row-kv"><span>Dƒ±≈ü Bor√ß:</span> <span id="eco-debt">$350B</span></div>
            </div>

            <div class="card">
                <div class="card-head">K√úRESEL Tƒ∞CARET</div>
                <div style="font-size:11px; color:#888; margin-bottom:5px;">ƒ∞thalat/ƒ∞hracat Dengesi</div>
                <button class="btn-main" onclick="game.trade('buy_oil')">
                    <span>Petrol ƒ∞thal Et (1000 varil)</span> <span class="cost-tag">-$50M</span>
                </button>
                <button class="btn-main" onclick="game.trade('buy_tech')">
                    <span>√áip Tedariƒüi</span> <span class="cost-tag">-$100M</span>
                </button>
                <button class="btn-main btn-danger" onclick="game.trade('debt_imf')">
                    <span>IMF Acil Kredi</span> <span class="cost-tag">+$10B / +Baƒüƒ±mlƒ±lƒ±k</span>
                </button>
            </div>
        </div>

        <div id="tab-l-soc" class="content-area">
            <div class="card">
                <div class="card-head">TOPLUMSAL Dƒ∞NAMƒ∞KLER</div>
                <div class="row-kv"><span>Sivil Huzursuzluk:</span> <span id="soc-unrest" style="color:var(--cyber-orange)">Orta (%40)</span></div>
                <div class="row-kv"><span>Ter√∂r Riski:</span> <span id="soc-terror" style="color:var(--cyber-red)">Y√ºksek</span></div>
                <div class="bar-cont"><div class="bar-fill" id="bar-terror" style="width:70%; background:var(--cyber-red)"></div></div>
            </div>
            
            <div class="card">
                <div class="card-head">MEDYA VE PROPAGANDA</div>
                <button class="btn-main" onclick="game.action('prop_national')">
                    <span>Ulusa Sesleni≈ü (Milliyet√ßi)</span> <span class="cost-tag">20 PP</span>
                </button>
                <button class="btn-main" onclick="game.action('prop_fear')">
                    <span>Tehdit Algƒ±sƒ± Yarat (Korku)</span> <span class="cost-tag">30 PP</span>
                </button>
                <button class="btn-main" onclick="game.action('int_raid')">
                    <span>H√ºcre Evlerine Baskƒ±n</span> <span class="cost-tag">G√ºvenlik</span>
                </button>
            </div>
        </div>

        <div id="tab-l-res" class="content-area">
            <div class="card">
                <div class="card-head">AR-GE MERKEZƒ∞</div>
                <div style="text-align:center; color:var(--cyber-blue); font-size:20px; font-weight:bold; margin:5px;" id="val-tech">0.0 RP</div>
                <div id="tech-tree"></div>
            </div>
        </div>
    </div>

    <div class="panel" id="map-wrapper">
        <canvas id="map-canvas"></canvas>
        
        <div id="map-ui">
            <button class="map-mode active" onclick="map.setMode('pol')">Sƒ∞YASƒ∞</button>
            <button class="map-mode" onclick="map.setMode('mil')">ASKERƒ∞ CEPHE</button>
            <button class="map-mode" onclick="map.setMode('eco')">KAYNAK</button>
            <button class="map-mode" onclick="map.setMode('intel')">ƒ∞STƒ∞HBARAT</button>
        </div>

        <div id="province-detail">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #444; padding-bottom:5px; margin-bottom:5px;">
                <span id="pd-name" style="font-family:var(--font-head); font-size:22px; color:var(--cyber-blue)">B√ñLGE</span>
                <span id="pd-flag" style="font-size:18px;">üáπüá∑</span>
            </div>
            
            <div class="row-kv"><span>Kontrol:</span> <span id="pd-owner">Biz</span></div>
            <div class="row-kv"><span>Altyapƒ±:</span> <span id="pd-infra">100%</span></div>
            <div class="row-kv"><span>N√ºfus Sadakati:</span> <span id="pd-loyalty">90%</span></div>
            <div class="row-kv"><span>Direni≈ü G√ºc√º:</span> <span id="pd-risk" style="color:var(--cyber-red)">0%</span></div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:4px; margin-top:8px;">
                <button class="btn-main" style="font-size:10px;" onclick="game.provAction('invest')">YATIRIM ($100)</button>
                <button class="btn-main" style="font-size:10px;" onclick="game.provAction('fortify')">G√ú√áLENDƒ∞R (ENG)</button>
                <button class="btn-main btn-danger" style="font-size:10px;" onclick="game.provAction('suppress')">BASKILA (ORDU)</button>
                <button class="btn-main" style="font-size:10px;" onclick="game.provAction('nuke')" id="btn-nuke" disabled>‚ò¢Ô∏è N√úKLEER</button>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="nav-tabs">
            <button class="nav-btn active" onclick="ui.tab('r', 'mil')"><i class="fa-solid fa-jet-fighter"></i></button>
            <button class="nav-btn" onclick="ui.tab('r', 'dip')"><i class="fa-solid fa-globe"></i></button>
            <button class="nav-btn" onclick="ui.tab('r', 'intel')"><i class="fa-solid fa-user-secret"></i></button>
        </div>

        <div id="tab-r-mil" class="content-area active">
            <div class="card">
                <div class="card-head">GENELKURMAY</div>
                <div class="row-kv"><span>ƒ∞nsan G√ºc√º:</span> <span id="mil-man">1.2M</span></div>
                <div class="row-kv"><span>Lojistik Aƒüƒ±:</span> <span id="mil-log" style="color:var(--cyber-orange)">%85</span></div>
                <div class="row-kv"><span>Sava≈ü Yorgunluƒüu:</span> <span id="mil-fat">%0</span></div>
            </div>

            <div class="card">
                <div class="card-head">ENVANTER & √úRETƒ∞M</div>
                <div class="row-kv"><i class="fa-solid fa-person-rifle"></i> Piyade <span id="cnt-inf">0</span> <button class="cost-tag" onclick="game.recruit('inf')">+KUR</button></div>
                <div class="row-kv"><i class="fa-solid fa-tank"></i> Tank <span id="cnt-tank">0</span> <button class="cost-tag" onclick="game.recruit('tank')">+KUR</button></div>
                <div class="row-kv"><i class="fa-solid fa-jet-fighter"></i> Jet <span id="cnt-jet">0</span> <button class="cost-tag" onclick="game.recruit('jet')">+KUR</button></div>
                <div class="row-kv"><i class="fa-solid fa-ship"></i> Donanma <span id="cnt-ship">0</span> <button class="cost-tag" onclick="game.recruit('ship')">+KUR</button></div>
                <div class="row-kv"><i class="fa-solid fa-robot"></i> Sƒ∞HA <span id="cnt-drone">0</span> <button class="cost-tag" onclick="game.recruit('drone')">+KUR</button></div>
            </div>

            <div class="card">
                <div class="card-head">STRATEJƒ∞K DOKTRƒ∞N</div>
                <select id="mil-doc" style="width:100%; background:#000; color:#fff; border:1px solid #333; padding:5px;" onchange="game.setDoctrine(this.value)">
                    <option value="def">Tam Savunma (Defans +%20)</option>
                    <option value="blitz">Yƒ±ldƒ±rƒ±m Harbi (Hƒ±z +%30)</option>
                    <option value="guerilla">Gerilla Harbi (Yƒ±pratma)</option>
                    <option value="shock">≈ûok ve Deh≈üet (Hava +%50)</option>
                </select>
            </div>
        </div>

        <div id="tab-r-dip" class="content-area">
            <div class="card">
                <div class="card-head">ULUSLARARASI ƒ∞Lƒ∞≈ûKƒ∞LER</div>
                <div id="diplo-list"></div>
            </div>
            <div class="card" id="diplo-actions" style="display:none">
                <div class="card-head" id="da-title">√úLKE ADI</div>
                <button class="btn-main" onclick="game.diploAction('improve')">ƒ∞li≈ükileri Geli≈ütir (50 PP)</button>
                <button class="btn-main" onclick="game.diploAction('alliance')">ƒ∞ttifak Teklif Et</button>
                <button class="btn-main" onclick="game.diploAction('trade_deal')">Ticaret Anla≈ümasƒ±</button>
                <button class="btn-main btn-danger" onclick="game.diploAction('embargo')">Ambargo Uygula</button>
                <button class="btn-main btn-danger" onclick="game.diploAction('war')">SAVA≈û ƒ∞LAN ET</button>
            </div>
        </div>

        <div id="tab-r-intel" class="content-area">
            <div class="card">
                <div class="card-head">Mƒ∞T & Sƒ∞BER OPERASYONLAR</div>
                <button class="btn-main" onclick="game.intelOp('coup')">
                    <span>Yabancƒ± √úlkede Darbe Planla</span> <span class="cost-tag">500 INT</span>
                </button>
                <button class="btn-main" onclick="game.intelOp('cyber')">
                    <span>Siber Saldƒ±rƒ± (Altyapƒ±)</span> <span class="cost-tag">100 INT</span>
                </button>
                <button class="btn-main" onclick="game.intelOp('steal')">
                    <span>Teknoloji √áal</span> <span class="cost-tag">250 INT</span>
                </button>
            </div>
            <div id="intel-log" style="font-family:var(--font-mono); font-size:10px; height:200px; overflow-y:auto; color:#8b949e; border-top:1px solid #333; padding-top:5px;">
                <div style="color:var(--cyber-green)">> Sƒ∞STEM √áEVRƒ∞Mƒ∞√áƒ∞...</div>
            </div>
        </div>
    </div>
</div>

<div id="news-ticker">
    <div id="ticker-content" style="animation: scroll-left 40s linear infinite; padding-left: 100%;">
        ++ SON DAKƒ∞KA: K√úRESEL ENERJƒ∞ KRƒ∞Zƒ∞ B√úY√úYOR ++ BM G√úVENLƒ∞K KONSEYƒ∞ ACƒ∞L TOPLANDI ++ BORSALARDA SERT D√ú≈û√ú≈û ++ YENƒ∞ SALGIN TEHLƒ∞KESƒ∞ ++
    </div>
</div>

<div class="modal-overlay" id="event-modal">
    <div class="modal-window">
        <div class="mw-header">
            <span id="ev-title">OLAY BA≈ûLIƒûI</span>
            <i class="fa-solid fa-triangle-exclamation" style="color:var(--cyber-red)"></i>
        </div>
        <div class="mw-body" id="ev-body">
            Olay metni buraya gelecek...
        </div>
        <div class="mw-footer" id="ev-actions">
            </div>
    </div>
</div>

<script>
/**
 * AETERNA: OMEGA v5.0
 * Comprehensive Grand Strategy Engine in a Single File.
 * Author: Gemini (Simulated)
 */

/* --- DATA & CONFIG --- */
const CONFIG = {
    startYear: 2025,
    tickRate: 1000, // ms per day
    colors: {
        player: '#00f3ff',
        ally: '#0aff0a',
        enemy: '#ff2a2a',
        neutral: '#888'
    }
};

const WORLD_DATA = {
    nations: [
        { id: 'usa', name: 'ABD', power: 100, stance: 'Neutral', rel: 50, alliance: 'NATO' },
        { id: 'rus', name: 'Rusya', power: 85, stance: 'Rival', rel: 30, alliance: 'East' },
        { id: 'chn', name: '√áin', power: 90, stance: 'Rival', rel: 40, alliance: 'East' },
        { id: 'eu', name: 'Avrupa B.', power: 80, stance: 'Friendly', rel: 60, alliance: 'NATO' },
        { id: 'grc', name: 'Yunanistan', power: 20, stance: 'Hostile', rel: 10, alliance: 'NATO' },
        { id: 'irn', name: 'ƒ∞ran', power: 40, stance: 'Neutral', rel: 45, alliance: 'None' },
        { id: 'isr', name: 'ƒ∞srail', power: 50, stance: 'Neutral', rel: 35, alliance: 'None' }
    ],
    techs: [
        { id: 't1', name: 'End√ºstri 4.0', cost: 200, icon: 'fa-industry' },
        { id: 't2', name: 'Yapay Zeka', cost: 500, icon: 'fa-brain' },
        { id: 't3', name: 'N√ºkleer Enerji', cost: 1000, icon: 'fa-atom' },
        { id: 't4', name: 'Kuantum Radar', cost: 800, icon: 'fa-wifi' },
        { id: 't5', name: 'Uzay Savunma', cost: 2000, icon: 'fa-satellite' }
    ],
    provinces: [
        // Basitle≈ütirilmi≈ü harita d√ºƒü√ºmleri
        { id:0, name:'Ankara', x:350, y:200, owner:'player', pop:6, type:'city' },
        { id:1, name:'ƒ∞stanbul', x:250, y:150, owner:'player', pop:16, type:'ind' },
        { id:2, name:'ƒ∞zmir', x:180, y:280, owner:'player', pop:4, type:'port' },
        { id:3, name:'Antalya', x:300, y:350, owner:'player', pop:2, type:'tour' },
        { id:4, name:'Diyarbakƒ±r', x:550, y:280, owner:'player', pop:2, type:'city' },
        { id:5, name:'Erzurum', x:500, y:180, owner:'player', pop:1, type:'mil' },
        { id:6, name:'Atina', x:100, y:300, owner:'grc', pop:3, type:'city' },
        { id:7, name:'Selanik', x:120, y:200, owner:'grc', pop:1, type:'port' },
        { id:8, name:'≈ûam', x:550, y:400, owner:'terror', pop:2, type:'war' },
        { id:9, name:'Baƒüdat', x:650, y:450, owner:'terror', pop:5, type:'war' },
        { id:10, name:'Tebriz', x:650, y:250, owner:'irn', pop:2, type:'city' },
        { id:11, name:'Moskova (Uzak)', x:500, y:50, owner:'rus', pop:12, type:'cap' }
    ]
};

/* --- CORE ENGINE --- */
const game = {
    state: {
        date: new Date(2025, 0, 1),
        paused: false,
        resources: {
            money: 5000, // Million $
            pp: 250, // Political Power
            intel: 50,
            energy: 100, // Energy Units
            oil: 500, // Barrels (k)
            tech: 0
        },
        stats: {
            gdp: 900, // Billion $
            debt: 200,
            stability: 60,
            warSupport: 50,
            defcon: 5,
            inflation: 15
        },
        military: {
            manpower: 800000,
            logistics: 90,
            fatigue: 0,
            doctrine: 'def',
            units: { inf:50, tank:5, jet:2, ship:3, drone:10 }
        },
        diplomacy: {}, // Map of nation IDs to relation data
        provinces: [],
        wars: [],
        events: []
    },

    timer: null,
    selectedProv: null,
    selectedNation: null,

    init() {
        console.log("OMEGA ENGINE STARTING...");
        
        // Initialize State
        WORLD_DATA.provinces.forEach(p => {
            this.state.provinces.push({
                ...p,
                loyalty: p.owner === 'player' ? 90 : 0,
                risk: p.owner === 'terror' ? 100 : 5,
                infrastructure: 80,
                troops: p.owner === 'player' ? 5 : 10
            });
        });

        WORLD_DATA.nations.forEach(n => {
            this.state.diplomacy[n.id] = { 
                rel: n.rel, 
                embargo: false, 
                alliance: false, 
                atWar: false 
            };
        });

        ui.init();
        map.init();
        this.loop();
    },

    loop() {
        if(this.timer) clearInterval(this.timer);
        this.timer = setInterval(() => {
            if(!this.state.paused) this.tick();
        }, CONFIG.tickRate);
    },

    tick() {
        const s = this.state;
        s.date.setDate(s.date.getDate() + 1);

        // 1. ECONOMY CALCULATION
        const dailyIncome = (s.stats.gdp * 0.05) / 365; // Tax revenue
        const armyMaint = this.calcArmyCost();
        const debtInterest = (s.stats.debt * 0.05) / 365;
        
        s.resources.money += (dailyIncome - armyMaint - debtInterest);
        s.resources.pp += 0.5;
        s.resources.intel += 0.2;
        s.resources.oil -= (Object.values(s.military.units).reduce((a,b)=>a+b,0) * 0.01); // Fuel usage

        // 2. STABILITY & RISKS
        if(s.resources.money < 0) {
            s.stats.debt += Math.abs(s.resources.money);
            s.resources.money = 0;
            s.stats.inflation += 0.01;
            s.stats.stability -= 0.05;
        }
        if(s.resources.oil <= 0) {
            s.military.logistics = Math.max(10, s.military.logistics - 1);
            ui.log("KRƒ∞Tƒ∞K: YAKIT T√úKENDƒ∞! ORDU DURMA NOKTASINDA!", true);
        }

        // 3. AI & DIPLOMACY SIMULATION
        if(Math.random() < 0.01) this.aiEvent();

        // 4. BATTLE CALCULATION (If at war)
        this.calcBattles();

        ui.update();
        map.draw();
    },

    calcArmyCost() {
        const u = this.state.military.units;
        return (u.inf*0.1) + (u.tank*0.5) + (u.jet*2) + (u.ship*3) + (u.drone*0.2);
    },

    calcBattles() {
        // Simple abstract battle logic per province
        this.state.provinces.forEach(p => {
            if(p.owner === 'player' && p.risk > 80) {
                // Insurgency battle
                if(Math.random() < 0.1) {
                    p.troops -= 1;
                    ui.log(`${p.name} b√∂lgesinde √ßatƒ±≈üma! Kayƒ±p verdik.`, true);
                    s.stats.stability -= 1;
                }
            }
        });
    },

    aiEvent() {
        const nations = WORLD_DATA.nations;
        const actor = nations[Math.floor(Math.random() * nations.length)];
        const actions = ['embargo', 'drill', 'statement', 'crisis'];
        const act = actions[Math.floor(Math.random() * actions.length)];

        let msg = "";
        if(act === 'embargo') msg = `${actor.name} ticaret kƒ±sƒ±tlamalarƒ± getirdi.`;
        if(act === 'drill') msg = `${actor.name} sƒ±nƒ±rda askeri tatbikat ba≈ülattƒ±.`;
        if(act === 'statement') msg = `${actor.name} lideri sert a√ßƒ±klamalarda bulundu.`;
        if(act === 'crisis') {
            msg = `EKONOMƒ∞K ≈ûOK: ${actor.name} borsasƒ± √ß√∂kt√º!`;
            this.state.stats.gdp -= 10;
        }

        ui.ticker(msg);
    },

    // --- PLAYER ACTIONS ---
    togglePause() {
        this.state.paused = !this.state.paused;
        document.getElementById('date-display').style.color = this.state.paused ? 'red' : 'var(--cyber-gold)';
    },

    toggleDefcon() {
        let d = this.state.stats.defcon - 1;
        if(d < 1) d = 5;
        this.state.stats.defcon = d;
        ui.update();
    },

    recruit(type) {
        const costs = { inf:100, tank:500, jet:2000, ship:3000, drone:300 };
        const cost = costs[type];
        if(this.state.resources.money >= cost) {
            this.state.resources.money -= cost;
            this.state.military.units[type]++;
            ui.log(`${type.toUpperCase()} birliƒüi sipari≈ü edildi.`);
            ui.update();
        } else {
            ui.log("Yetersiz Fon!", true);
        }
    },

    action(act) {
        const s = this.state;
        if(act === 'law_martial') {
            if(s.resources.pp >= 150) {
                s.resources.pp -= 150;
                s.stats.stability += 20;
                s.stats.gdp *= 0.95; // Economy hurt
                ui.log("Sƒ±kƒ±y√∂netim ilan edildi. D√ºzen saƒülandƒ±, ekonomi yava≈üladƒ±.");
            }
        }
        else if(act === 'prop_national') {
            if(s.resources.pp >= 20) {
                s.resources.pp -= 20;
                s.stats.warSupport += 5;
                ui.log("Propaganda yayƒ±nƒ± yapƒ±ldƒ±.");
            }
        }
        // ... more actions
    },

    trade(type) {
        if(type === 'buy_oil') {
            if(this.state.resources.money >= 50) {
                this.state.resources.money -= 50;
                this.state.resources.oil += 1000;
                ui.log("Petrol sevkiyatƒ± limana ula≈ütƒ±.");
            }
        }
        if(type === 'debt_imf') {
            this.state.resources.money += 10000;
            this.state.stats.debt += 12000;
            this.state.resources.pp -= 50;
            ui.log("IMF Kredisi onaylandƒ±. Baƒüƒ±msƒ±zlƒ±k azaldƒ±.");
        }
    },

    diploAction(type) {
        if(!this.selectedNation) return;
        const nid = this.selectedNation.id;
        const rel = this.state.diplomacy[nid];
        const pp = this.state.resources.pp;

        if(type === 'improve') {
            if(pp >= 50) {
                this.state.resources.pp -= 50;
                rel.rel += 10;
                ui.log("Diplomatik heyet g√∂nderildi.");
            }
        }
        if(type === 'war') {
            this.triggerEvent("SAVA≈û ƒ∞LANI", `${this.selectedNation.name} ile sava≈üa girmek √ºzeresiniz. Bu geri d√∂n√ºlemez bir karar.`, [
                { txt: "SALDIR", act: () => { 
                    rel.atWar = true; 
                    this.state.stats.defcon = 1; 
                    ui.log("SAVA≈û BA≈ûLADI!"); 
                }},
                { txt: "ƒ∞PTAL", act: () => {} }
            ]);
        }
        ui.refreshDiplo();
    },

    provAction(type) {
        if(this.selectedProv === null) return;
        const p = this.state.provinces[this.selectedProv];
        
        if(type === 'invest') {
            if(this.state.resources.money >= 100) {
                this.state.resources.money -= 100;
                p.infrastructure += 5;
                ui.log(`${p.name} altyapƒ±sƒ± geli≈ütirildi.`);
            }
        }
        else if(type === 'suppress') {
            p.risk = Math.max(0, p.risk - 20);
            p.loyalty -= 5;
            ui.log("Askeri m√ºdahale yapƒ±ldƒ±.");
        }
        ui.update();
    },

    triggerEvent(title, body, buttons) {
        const m = document.getElementById('event-modal');
        document.getElementById('ev-title').innerText = title;
        document.getElementById('ev-body').innerText = body;
        const f = document.getElementById('ev-actions');
        f.innerHTML = '';
        
        buttons.forEach(b => {
            const btn = document.createElement('button');
            btn.className = 'btn-main';
            btn.style.width = 'auto';
            btn.innerText = b.txt;
            btn.onclick = () => {
                b.act();
                m.style.display = 'none';
            };
            f.appendChild(btn);
        });
        m.style.display = 'flex';
    }
};

/* --- UI CONTROLLER --- */
const ui = {
    init() {
        this.renderTechTree();
        this.renderDiploList();
        
        // Setup Parliament Chart
        const ctx = document.getElementById('parliament-chart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['ƒ∞ktidar', 'Muhalefet', 'Diƒüer'],
                datasets: [{ data: [320, 200, 80], backgroundColor: ['#00f3ff', '#ff2a2a', '#777'], borderWidth:0 }]
            },
            options: { cutout: '70%', plugins: {legend:{display:false}} }
        });
    },

    update() {
        const s = game.state;
        
        // HUD
        document.getElementById('hud-money').innerText = `$${Math.floor(s.resources.money)}M`;
        document.getElementById('hud-pp').innerText = Math.floor(s.resources.pp);
        document.getElementById('hud-intel').innerText = Math.floor(s.resources.intel);
        document.getElementById('hud-energy').innerText = s.resources.energy + '%';
        document.getElementById('hud-oil').innerText = Math.floor(s.resources.oil) + 'k';
        document.getElementById('hud-stab').innerText = Math.floor(s.stats.stability) + '%';
        
        const def = document.getElementById('defcon-disp');
        def.innerText = "DEFCON " + s.stats.defcon;
        def.style.color = s.stats.defcon === 1 ? '#fff' : 'var(--cyber-red)';
        def.style.background = s.stats.defcon === 1 ? 'var(--cyber-red)' : 'transparent';

        document.getElementById('date-display').innerText = s.date.toLocaleDateString('tr-TR');

        // ECO
        document.getElementById('eco-gdp').innerText = `$${Math.floor(s.stats.gdp)}B`;
        document.getElementById('eco-debt').innerText = `$${Math.floor(s.stats.debt)}B`;

        // MILITARY
        document.getElementById('cnt-inf').innerText = s.military.units.inf;
        document.getElementById('cnt-tank').innerText = s.military.units.tank;
        document.getElementById('cnt-jet').innerText = s.military.units.jet;
        document.getElementById('cnt-ship').innerText = s.military.units.ship;
        document.getElementById('cnt-drone').innerText = s.military.units.drone;

        // Province Detail
        if(game.selectedProv !== null) {
            const p = game.state.provinces[game.selectedProv];
            document.getElementById('pd-risk').innerText = Math.floor(p.risk) + '%';
            document.getElementById('pd-loyalty').innerText = Math.floor(p.loyalty) + '%';
            document.getElementById('pd-infra').innerText = Math.floor(p.infrastructure) + '%';
        }
    },

    renderTechTree() {
        const c = document.getElementById('tech-tree');
        WORLD_DATA.techs.forEach(t => {
            c.innerHTML += `
                <div class="btn-main" style="opacity:${game.state.resources.tech >= t.cost ? 1 : 0.6}">
                    <div><i class="fa-solid ${t.icon}"></i> ${t.name}</div>
                    <div class="cost-tag">${t.cost} RP</div>
                </div>
            `;
        });
    },

    renderDiploList() {
        const c = document.getElementById('diplo-list');
        c.innerHTML = '';
        WORLD_DATA.nations.forEach(n => {
            const d = game.state.diplomacy[n.id];
            let tag = '';
            if(d.atWar) tag = '<span class="tag-diplo tag-enemy">SAVA≈ûTA</span>';
            else if(d.rel > 80) tag = '<span class="tag-diplo tag-ally">DOST</span>';
            else if(d.rel < 20) tag = '<span class="tag-diplo tag-enemy">D√ú≈ûMAN</span>';
            
            const el = document.createElement('div');
            el.className = 'btn-main';
            el.innerHTML = `<span>${n.name}</span> <div>${tag} <span style="font-size:10px">${d.rel} Rel</span></div>`;
            el.onclick = () => {
                game.selectedNation = n;
                document.getElementById('diplo-actions').style.display = 'block';
                document.getElementById('da-title').innerText = n.name + " Dƒ∞PLOMASƒ∞Sƒ∞";
            };
            c.appendChild(el);
        });
    },

    refreshDiplo() {
        this.renderDiploList();
    },

    log(msg, isErr=false) {
        const l = document.getElementById('intel-log');
        const color = isErr ? 'var(--cyber-red)' : '#00f3ff';
        l.innerHTML = `<div style="color:${color}; margin-bottom:2px;">> ${msg}</div>` + l.innerHTML;
    },

    ticker(msg) {
        const t = document.getElementById('ticker-content');
        t.innerText += " ++ " + msg;
    },

    tab(side, id) {
        const p = side==='l' ? 0 : 2;
        const panel = document.querySelectorAll('.panel')[p];
        panel.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        panel.querySelectorAll('.content-area').forEach(c => c.classList.remove('active'));
        event.currentTarget.classList.add('active');
        document.getElementById(`tab-${side}-${id}`).classList.add('active');
    }
};

/* --- MAP RENDERER --- */
const map = {
    canvas: null, ctx: null, mode: 'pol',

    init() {
        this.canvas = document.getElementById('map-canvas');
        this.ctx = this.canvas.getContext('2d');
        
        new ResizeObserver(()=>this.resize()).observe(document.getElementById('map-wrapper'));
        this.canvas.addEventListener('mousedown', e => this.click(e));
        
        this.resize();
        this.animate();
    },

    setMode(m) {
        this.mode = m;
        document.querySelectorAll('.map-mode').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
    },

    resize() {
        this.canvas.width = document.getElementById('map-wrapper').offsetWidth;
        this.canvas.height = document.getElementById('map-wrapper').offsetHeight;
    },

    draw() {
        const ctx = this.ctx;
        const w = this.canvas.width;
        const h = this.canvas.height;
        
        ctx.fillStyle = '#050505';
        ctx.fillRect(0,0,w,h);
        
        // Grid Effect
        ctx.strokeStyle = '#111'; ctx.lineWidth=1;
        for(let i=0; i<w; i+=40) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,h); ctx.stroke(); }
        for(let i=0; i<h; i+=40) { ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(w,i); ctx.stroke(); }

        // Connections
        ctx.strokeStyle = '#333';
        const provs = game.state.provinces;
        provs.forEach((p1, i) => {
            provs.forEach((p2, j) => {
                if(i<j && Math.hypot(p1.x-p2.x, p1.y-p2.y) < 180) {
                    ctx.beginPath(); ctx.moveTo(p1.x, p1.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
                }
            });
        });

        // Nodes
        provs.forEach(p => {
            let color = '#555';
            let radius = 6 + (p.pop/2);

            // Mode Logic
            if(this.mode === 'pol') {
                if(p.owner === 'player') color = CONFIG.colors.player;
                else if(p.owner === 'terror') color = '#000'; // Black Ops
                else {
                    const nat = WORLD_DATA.nations.find(n => n.id === p.owner);
                    if(nat) {
                         const rel = game.state.diplomacy[nat.id];
                         color = rel.atWar ? CONFIG.colors.enemy : (rel.rel > 80 ? CONFIG.colors.ally : CONFIG.colors.neutral);
                    }
                }
            }
            else if(this.mode === 'mil') {
                const threat = p.risk / 100;
                color = `rgba(255, ${255-(threat*255)}, ${255-(threat*255)}, 1)`;
            }

            // Selection Glow
            if(game.selectedProv === p.id) {
                ctx.shadowBlur = 15; ctx.shadowColor = '#fff'; ctx.fillStyle = '#fff';
            } else {
                ctx.shadowBlur = 0; ctx.fillStyle = color;
            }

            // Terror/War Indicator
            if(p.owner === 'terror' || (p.owner==='player' && p.risk>80)) {
                ctx.shadowBlur = 10; ctx.shadowColor = 'red';
                radius += Math.sin(Date.now()/200)*2; // Pulse
            }

            ctx.beginPath(); ctx.arc(p.x, p.y, radius, 0, Math.PI*2); ctx.fill();
            
            // Text
            ctx.fillStyle = '#ccc'; ctx.font = '10px Rajdhani'; ctx.textAlign = 'center'; ctx.shadowBlur=0;
            ctx.fillText(p.name, p.x, p.y - radius - 5);
        });
    },

    animate() {
        this.draw();
        requestAnimationFrame(()=>this.animate());
    },

    click(e) {
        const rect = this.canvas.getBoundingClientRect();
        const mx = e.clientX - rect.left;
        const my = e.clientY - rect.top;

        let found = null;
        game.state.provinces.forEach(p => {
            if(Math.hypot(mx-p.x, my-p.y) < 20) found = p;
        });

        if(found) {
            game.selectedProv = found.id;
            document.getElementById('province-detail').style.display = 'block';
            document.getElementById('pd-name').innerText = found.name;
            document.getElementById('pd-owner').innerText = found.owner === 'player' ? 'Bƒ∞Zƒ∞M KONTROLDE' : 'YABANCI B√ñLGE';
            ui.update();
        } else {
            game.selectedProv = null;
            document.getElementById('province-detail').style.display = 'none';
        }
    }
};

window.onload = () => game.init();
</script>
</body>
</html>
